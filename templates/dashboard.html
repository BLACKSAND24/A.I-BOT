<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI/ML Crypto Trading Terminal</title>

<!-- Chart.js for charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Tabulator for trade history -->
<link href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator.min.css" rel="stylesheet">
<script src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.min.js"></script>

<style>
body { font-family: Arial, sans-serif; margin:0; background:#f4f6f8; color:#333; }
header { background:#1e1e2f; color:white; padding:15px; display:flex; justify-content:space-between; align-items:center; }
header h1 { margin:0; font-size:1.5em; }
.controls { display:flex; gap:10px; }
.controls input, .controls select { padding:5px; font-size:1em; }
.tabs { display:flex; background:#fff; cursor:pointer; }
.tab { padding:10px 20px; border-bottom:3px solid transparent; }
.tab.active { border-bottom:3px solid #1e88e5; font-weight:bold; }
.section { padding:20px; display:none; }
.cards { display:flex; gap:15px; margin-bottom:20px; flex-wrap:wrap; }
.card { background:white; padding:15px; flex:1; text-align:center; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
#chartContainer, #liveChartContainer, #indicatorContainer { background:white; padding:15px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); margin-bottom:20px; }
#tradeTable, #liveTradeTable { background:white; padding:10px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); margin-bottom:20px; }
.tooltip { color:#666; font-size:0.85em; margin-top:5px; }
.signal-card { background:#fff; padding:10px 15px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); margin-bottom:10px; font-weight:bold; }
.signal-buy { color:green; }
.signal-sell { color:red; }
.signal-hold { color:gray; }
.help-note { background:#e3f2fd; padding:10px; border-left:5px solid #1e88e5; border-radius:5px; margin-bottom:15px; font-size:0.9em; }
</style>
</head>
<body>

<header>
  <h1>AI/ML Crypto Trading Terminal</h1>
  <div class="controls">
    <select id="mlModel">
      <option>LSTM</option>
      <option>XGBoost</option>
    </select>
    <input type="number" id="capital" placeholder="Starting Capital ($)" value="10000">
  </div>
</header>

<div class="tabs">
  <div class="tab active" data-tab="backtest">Backtesting</div>
  <div class="tab" data-tab="liveDemo">Live Demo</div>
</div>

<!-- Backtesting Section -->
<div class="section" id="backtestSection" style="display:block;">
  <div class="help-note">
    <strong>Backtesting:</strong> This shows how your strategy would have performed on historical data. Use it to understand potential profits/losses before trading real money.
  </div>

  <div id="chartContainer">
    <canvas id="portfolioChart"></canvas>
    <div class="tooltip">Portfolio growth using selected AI/ML strategy.</div>
  </div>

  <div class="cards">
    <div class="card" id="totalReturn">Total Return: $0 (0%)</div>
    <div class="card" id="tradesCount">Trades: 0</div>
    <div class="card" id="winRate">Win Rate: 0%</div>
    <div class="card" id="maxDrawdown">Max Drawdown: $0</div>
  </div>

  <div id="tradeTable"></div>
</div>

<!-- Live Demo Section -->
<div class="section" id="liveDemoSection">
  <div class="help-note">
    <strong>Live Demo Trading:</strong> Watch AI/ML simulate trades in real-time. Do not trade real money blindly; this is for learning.
  </div>

  <div class="signal-card" id="latestSignal">Waiting for AI/ML signal...</div>

  <div id="liveChartContainer">
    <canvas id="livePortfolioChart"></canvas>
    <div class="tooltip">Simulated portfolio value over time with AI/ML signals.</div>
  </div>

  <div class="cards">
    <div class="card" id="liveTotalReturn">Total Return: $0 (0%)</div>
    <div class="card" id="liveTradesCount">Trades: 0</div>
  </div>

  <div id="liveTradeTable"></div>

  <!-- AI/ML Decision Explanation -->
  <div class="signal-card" id="aiExplanation">Waiting for AI/ML explanation...</div>
  <canvas id="indicatorChart" height="100"></canvas>
  <div class="tooltip">Shows the pattern detected by the AI/ML model that led to this decision.</div>
</div>

<script>
document.querySelectorAll('.tab').forEach(tab=>{
  tab.addEventListener('click', ()=>{
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');
    document.querySelectorAll('.section').forEach(s=>s.style.display='none');
    if(tab.dataset.tab==='backtest') document.getElementById('backtestSection').style.display='block';
    if(tab.dataset.tab==='liveDemo') document.getElementById('liveDemoSection').style.display='block';
  });
});

// ----- Backtesting -----
const backtestLabels=Array.from({length:50},(_,i)=>`T${i+1}`);
const backtestValues=Array.from({length:50},(_,i)=>10000+i*300+(Math.random()*500-250));

new Chart(document.getElementById('portfolioChart').getContext('2d'),{
  type:'line',
  data:{labels:backtestLabels,datasets:[{label:'Portfolio Value ($)',data:backtestValues,borderColor:'#1e88e5',backgroundColor:'rgba(30,136,229,0.2)',fill:true,tension:0.2,pointRadius:2}]},
  options:{responsive:true,plugins:{legend:{display:false},tooltip:{mode:'index',intersect:false}},interaction:{mode:'nearest',axis:'x',intersect:false},scales:{x:{title:{display:true,text:'Time Steps'}},y:{title:{display:true,text:'Portfolio Value ($)'}}}}
});

const totalReturnBT=backtestValues[backtestValues.length-1]-backtestValues[0];
document.getElementById('totalReturn').innerText=`Total Return: $${totalReturnBT.toFixed(2)} (${((totalReturnBT/backtestValues[0])*100).toFixed(2)}%)`;
document.getElementById('tradesCount').innerText=`Trades: ${backtestValues.length}`;
document.getElementById('winRate').innerText=`Win Rate: ${Math.floor(Math.random()*40+60)}%`;
document.getElementById('maxDrawdown').innerText=`Max Drawdown: $${Math.floor(Math.random()*1500+500)}`;

const backtestTrades=Array.from({length:50},(_,i)=>({id:i+1,symbol:'BTCUSDT',type:Math.random()>0.5?'Buy':'Sell',price:(27000+Math.random()*500).toFixed(2),quantity:(Math.random()*0.5).toFixed(3),pl:(Math.random()*500-250).toFixed(2)}));
new Tabulator("#tradeTable",{data:backtestTrades,layout:"fitColumns",columns:[{title:"#",field:"id", width:40},{title:"Symbol", field:"symbol"},{title:"Type", field:"type"},{title:"Price", field:"price"},{title:"Quantity", field:"quantity"},{title:"P/L ($)", field:"pl"}],pagination:"local",paginationSize:10,responsiveLayout:true});

// ----- Live Demo -----
let liveTrades=[];
let livePortfolio=10000;
const liveLabels=[],liveValues=[];
const liveChart=new Chart(document.getElementById('livePortfolioChart').getContext('2d'),{
  type:'line',
  data:{labels:liveLabels,datasets:[{label:'Simulated Portfolio ($)',data:liveValues,borderColor:'#43a047',backgroundColor:'rgba(67,160,71,0.2)',fill:true,tension:0.2,pointRadius:2}]},
  options:{responsive:true,plugins:{legend:{display:false}},scales:{x:{title:{display:true,text:'Time'}},y:{title:{display:true,text:'Portfolio ($)'}}}}
});

let indicatorChart;

function simulateLiveTrade(){
  const lastPrice=27000+Math.random()*1000-500;
  const model=document.getElementById('mlModel').value;
  let signal='Hold';
  if(model==='LSTM'&&lastPrice%2>1) signal='Buy';
  if(model==='LSTM'&&lastPrice%2<=1) signal='Sell';
  if(model==='XGBoost'&&lastPrice%3>1) signal='Buy';
  if(model==='XGBoost'&&lastPrice%3<=1) signal='Sell';

  document.getElementById('latestSignal').innerText=`${signal} BTCUSDT @ $${lastPrice.toFixed(2)} using ${model}`;
  document.getElementById('latestSignal').className=`signal-card signal-${signal.toLowerCase()}`;

  let quantity=(Math.random()*0.2).toFixed(3);
  if(signal==='Buy'){ livePortfolio+=quantity*(Math.random()*50); }
  if(signal==='Sell'){ livePortfolio-=quantity*(Math.random()*50); }

  liveTrades.unshift({id:liveTrades.length+1,symbol:'BTCUSDT',type:signal,price:lastPrice.toFixed(2),quantity,pl:(Math.random()*100-50).toFixed(2)});
  if(liveTrades.length>10) liveTrades.pop();

  liveLabels.push(`T${liveLabels.length+1}`); liveValues.push(livePortfolio.toFixed(2));
  if(liveLabels.length>50){ liveLabels.shift(); liveValues.shift(); }
  liveChart.update();

  document.getElementById('liveTotalReturn').innerText=`Total Return: $${(livePortfolio-10000).toFixed(2)} (${((livePortfolio-10000)/10000*100).toFixed(2)}%)`;
  document.getElementById('liveTradesCount').innerText=`Trades: ${liveTrades.length}`;

  new Tabulator("#liveTradeTable",{data:liveTrades,layout:"fitColumns",columns:[{title:"#",field:"id",width:40},{title:"Symbol",field:"symbol"},{title:"Type",field:"type"},{title:"Price",field:"price"},{title:"Quantity",field:"quantity"},{title:"P/L ($)",field:"pl"}],pagination:false,responsiveLayout:true});

  // AI/ML explanation
  let reason='Hold',confidence=50;
  if(signal==='Buy'){ reason=`Price crossed above 50-period moving average → Buy signal`; confidence=Math.floor(Math.random()*30+70);}
  if(signal==='Sell'){ reason=`XGBoost predicts downward trend probability → Sell signal`; confidence=Math.floor(Math.random()*30+60);}
  document.getElementById('aiExplanation').innerText=`${reason} (Confidence: ${confidence}%)`;

  const indicatorValues=Array.from({length:20},(_,i)=>lastPrice-Math.random()*500+250);
  if(typeof indicatorChart!=='undefined') indicatorChart.destroy();
  const ctxIndicator=document.getElementById('indicatorChart').getContext('2d');
  indicatorChart=new Chart(ctxIndicator,{
    type:'line',
    data:{labels:Array.from({length:20},(_,i)=>`T${i+1}`),datasets:[{label:'Price Trend',data:indicatorValues,borderColor:signal==='Buy'?'green':signal==='Sell'?'red':'gray',backgroundColor:'rgba(0,0,0,0)',tension:0.3}]},
    options:{responsive:true,plugins:{legend:{display:false}},scales:{x:{display:false},y:{display:false}}}
  });
}

setInterval(simulateLiveTrade,2000);
</script>

</body>
</html>
